<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å®¶åº­å…¬ä¼šï¼šV5åè®®</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Russo+One&display=swap" rel="stylesheet">
    
    <style>
        /* ================= æ ¸å¿ƒå®‡å®™è®¾å®š (CSS ä¿æŒä¸å˜) ================= */
        :root {
            --neon-blue: #00f3ff;
            --neon-purple: #bc13fe;
            --neon-red: #ff0055;
            --neon-gold: #ffe600;
            --bg-dark: #050510;
            --glass: rgba(10, 20, 40, 0.75);
            
            /* åŠ¨æ€ä¸»é¢˜å˜é‡ */
            --theme-color: var(--neon-blue);
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Orbitron', 'PingFang SC', 'Microsoft YaHei', sans-serif; 
            background-color: var(--bg-dark);
            color: #fff;
            margin: 0;
            padding: 15px;
            padding-bottom: 100px;
            overflow-x: hidden;
            min-height: 100vh;
            /* æ‰«æçº¿ç‰¹æ•ˆ */
            background-image: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
        }

        /* åŠ¨æ€æ˜Ÿç©ºç½‘æ ¼èƒŒæ™¯ */
        .bg-animation {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 50% 0%, #1a1a3a 0%, transparent 70%),
                linear-gradient(transparent 0%, var(--bg-dark) 100%);
            perspective: 1000px;
        }
        .grid-floor {
            position: absolute;
            bottom: -30%;
            left: -50%;
            width: 200%;
            height: 100%;
            background-image: 
                linear-gradient(var(--theme-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--theme-color) 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: center bottom;
            transform: rotateX(60deg);
            opacity: 0.15;
            animation: gridMove 20s linear infinite;
            mask-image: linear-gradient(to top, rgba(0,0,0,1) 0%, rgba(0,0,0,0) 60%);
        }

        @keyframes gridMove { 0% { transform: rotateX(60deg) translateY(0); } 100% { transform: rotateX(60deg) translateY(40px); } }

        /* ================= UI ç»„ä»¶ ================= */

        .hud-panel {
            border: 1px solid var(--theme-color);
            background: var(--glass);
            border-radius: 10px;
            padding: 15px;
            position: relative;
            box-shadow: 0 0 15px var(--theme-color), inset 0 0 20px rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            margin-bottom: 25px;
            overflow: hidden;
        }
        .hud-corner {
            position: absolute;
            width: 10px; height: 10px;
            border: 2px solid var(--theme-color);
            transition: all 0.3s;
        }
        .tl { top: -1px; left: -1px; border-right: 0; border-bottom: 0; }
        .tr { top: -1px; right: -1px; border-left: 0; border-bottom: 0; }
        .bl { bottom: -1px; left: -1px; border-right: 0; border-top: 0; }
        .br { bottom: -1px; right: -1px; border-left: 0; border-top: 0; }

        .profile-row { display: flex; align-items: center; gap: 15px; z-index: 2; position: relative; }
        
        .avatar-box {
            width: 70px; height: 70px;
            border-radius: 50%;
            border: 2px solid var(--theme-color);
            background: rgba(0,0,0,0.5);
            display: flex; justify-content: center; align-items: center;
            font-size: 2.5rem;
            position: relative;
            box-shadow: 0 0 10px var(--theme-color);
        }
        .avatar-ring {
            position: absolute; top: -5px; left: -5px; right: -5px; bottom: -5px;
            border: 1px dashed var(--theme-color);
            border-radius: 50%;
            animation: spin 10s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .stats-col { flex: 1; }
        .hero-name { font-family: 'Russo One', 'PingFang SC', sans-serif; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px; text-shadow: 0 0 5px var(--theme-color); }
        .hero-class { font-size: 0.7rem; color: #aaa; letter-spacing: 2px; margin-bottom: 5px; }

        .xp-wrapper { margin-top: 5px; position: relative; }
        .xp-bg { background: #111; height: 8px; border: 1px solid #333; transform: skewX(-20deg); }
        .xp-fill { 
            height: 100%; background: var(--theme-color); width: 0%; 
            box-shadow: 0 0 8px var(--theme-color);
            transition: width 0.5s ease;
        }
        .xp-txt { font-size: 0.6rem; position: absolute; right: 0; top: -12px; color: var(--theme-color); }

        .coin-hud {
            text-align: right;
            border-left: 1px solid rgba(255,255,255,0.1);
            padding-left: 15px;
        }
        .coin-val { 
            font-size: 2rem; font-weight: 900; color: var(--neon-gold); 
            text-shadow: 0 0 10px var(--neon-gold); 
            font-family: 'Russo One', sans-serif;
        }
        .coin-lbl { font-size: 0.6rem; color: #fff; opacity: 0.5; letter-spacing: 2px; }

        .switch-deck {
            display: flex; gap: 15px; margin-bottom: 20px;
        }
        .cyber-btn {
            flex: 1;
            background: rgba(0,0,0,0.6);
            border: 1px solid #333;
            color: #555;
            padding: 12px;
            font-family: 'Orbitron', 'PingFang SC', sans-serif;
            font-weight: bold;
            text-transform: uppercase;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
            transition: all 0.3s;
            position: relative;
        }
        .cyber-btn.active {
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--theme-color);
            color: var(--theme-color);
            text-shadow: 0 0 5px var(--theme-color);
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
        }
        .cyber-btn.active::before {
            content: ''; position: absolute; left: 0; bottom: 0; width: 10px; height: 10px; background: var(--theme-color);
        }

        .nav-deck {
            display: flex; justify-content: space-between;
            border-bottom: 2px solid rgba(255,255,255,0.1);
            margin-bottom: 20px;
            padding-bottom: 5px;
        }
        .nav-item {
            color: #666;
            font-size: 0.9rem;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        .nav-item.active {
            color: #fff;
            text-shadow: 0 0 8px #fff;
        }
        .nav-item.active::after {
            content: ''; position: absolute; bottom: -7px; left: 0; width: 100%; height: 2px;
            background: var(--theme-color);
            box-shadow: 0 -2px 5px var(--theme-color);
        }

        .grid-area {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); 
            gap: 15px;
        }
        .holo-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(0,0,0,0.4) 100%);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 15px;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s;
            cursor: pointer;
            display: flex; flex-direction: column; align-items: center; text-align: center;
        }
        .holo-card::before { 
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px;
            background: linear-gradient(90deg, transparent, var(--theme-color), transparent);
        }
        .holo-card:active { transform: scale(0.95); border-color: var(--theme-color); }

        .holo-icon { font-size: 2.5rem; margin-bottom: 10px; filter: drop-shadow(0 0 5px rgba(255,255,255,0.3)); }
        .holo-title { font-size: 0.9rem; font-weight: bold; color: #fff; margin-bottom: 5px; line-height: 1.2; }
        .holo-desc { font-size: 0.6rem; color: #888; margin-bottom: 10px; flex-grow: 1; }
        
        .reward-tag {
            background: rgba(0,0,0,0.6);
            border: 1px solid var(--theme-color);
            padding: 4px 10px;
            font-size: 0.8rem;
            color: var(--theme-color);
            font-weight: bold;
            box-shadow: 0 0 5px var(--theme-color);
        }
        .cost-tag { border-color: var(--neon-red); color: var(--neon-red); box-shadow: 0 0 5px var(--neon-red); }

        .shop-border { border: 1px dashed var(--neon-gold); }
        
        .footer { text-align: center; margin-top: 40px; opacity: 0.5; font-size: 0.7rem; letter-spacing: 2px; }
    </style>
</head>
<body>

    <div class="bg-animation">
        <div class="grid-floor"></div>
    </div>

    <div class="switch-deck">
        <div id="btn-mage" class="cyber-btn active" onclick="switchRole('mage')">
            ğŸ”¹ æ–½å¸¸é’° (å“¥å“¥)
        </div>
        <div id="btn-warrior" class="cyber-btn" onclick="switchRole('warrior')">
            ğŸ”¸ æ–½å¸¸æ¾ (å¼Ÿå¼Ÿ)
        </div>
    </div>

    <div class="hud-panel">
        <div class="hud-corner tl"></div><div class="hud-corner tr"></div>
        <div class="hud-corner bl"></div><div class="hud-corner br"></div>

        <div class="profile-row">
            <div class="avatar-box">
                <span id="ui-avatar">ğŸ§™â€â™‚ï¸</span>
                <div class="avatar-ring"></div>
            </div>
            <div class="stats-col">
                <div class="hero-name" id="ui-name">è§’è‰²å</div>
                <div class="hero-class" id="ui-title">å½“å‰å¤´è¡”</div>
                <div class="xp-wrapper">
                    <div class="xp-txt" id="ui-xp-txt">0/100</div>
                    <div class="xp-bg"><div class="xp-fill" id="ui-xp-bar"></div></div>
                </div>
            </div>
            <div class="coin-hud">
                <div class="coin-val" id="ui-gold">0</div>
                <div class="coin-lbl">å…¬ä¼šé‡‘å¸</div>
            </div>
        </div>
    </div>

    <div class="nav-deck">
        <div class="nav-item active" id="tab-daily" onclick="switchTab('daily')">æ—¥å¸¸ä»»åŠ¡</div>
        <div class="nav-item" id="tab-weekend" onclick="switchTab('weekend')">å‘¨æœ«æŒ‘æˆ˜</div>
        <div class="nav-item" id="tab-shop" onclick="switchTab('shop')">ç§¯åˆ†å†›æ¢°åº“</div>
    </div>

    <div id="content-area" class="grid-area">
        </div>

    <div class="footer">
        ç³»ç»Ÿ V5.7 // å¯†ç ä¿æŠ¤ä¸å®šåˆ¶ç‰ˆ<br>
        <a href="#" onclick="resetData()" style="color:#555; text-decoration:none">[ é‡ç½®ç³»ç»Ÿ ]</a>
    </div>

    <script>
        // ================= æ•°æ®é…ç½® (V5.7 å®šåˆ¶ç‰ˆ) =================

        // ã€ï¼ï¼ï¼é‡è¦è®¾ç½®ï¼ï¼ï¼ã€‘
        // è¯·åœ¨æ­¤å¤„ä¿®æ”¹æ‚¨çš„å®¶é•¿æˆæƒç  (PIN)ã€‚å»ºè®®ä½¿ç”¨ç®€å•çš„å››ä½æ•°å­—ã€‚
        const PARENT_PIN = "8888"; 
        
        const gameData = {
            mage: {
                name: "æ–½å¸¸é’°",
                avatar: "ğŸ§™â€â™‚ï¸",
                color: "#00f3ff", 
                levels: [
                    { xp: 0, title: "è§ä¹ å­¦å¾’" }, { xp: 100, title: "ç§˜æ³•å¸ˆ" }, 
                    { xp: 300, title: "å¤§é­”å¯¼å¸ˆ" }, { xp: 600, title: "æ˜Ÿé™…è´¤è€…" }
                ],
                // æ–½å¸¸é’° - æ—¥å¸¸ä»»åŠ¡ (10é¡¹) - ä¾§é‡è‡ªå¾‹ã€å­¦ä¹ ã€é«˜é˜¶ä¹ æƒ¯
                dailyTasks: [
                    { name: "ä¸ªäººæ¸…æ´", icon: "ğŸ§¼", gold: 1, xp: 3, desc: "æ—©æ™šä¸»åŠ¨æ´—è„¸ã€åˆ·ç‰™ã€è‡ªç†" },
                    { name: "æ™¨é—´åè®®: æ—©èµ·", icon: "â°", gold: 1, xp: 5, desc: "7:10å‰å®Œæˆå¯åŠ¨" },
                    { name: "è£…å¤‡å°±ç»ª", icon: "ğŸ‘š", gold: 1, xp: 3, desc: "æ•´ç†æ˜æ—¥è¡£ç‰©ä¸ç‰©å“" },
                    { name: "ç©ºé—´æ•´ç†", icon: "ğŸ§¹", gold: 1, xp: 5, desc: "æ•´ç†ä¹¦æ¡Œæˆ–åºŠé“º" },
                    
                    { name: "æ•°æ®å½•å…¥: ä½œä¸š", icon: "ğŸ’ ", gold: 3, xp: 10, desc: "å‡†ç¡®ç‡95%+" },
                    { name: "å­¦ä¹ æ¨¡å—å‡çº§", icon: "ğŸ’¡", gold: 2, xp: 10, desc: "è‡ªå­¦ä¸€é¡µè¯¾å¤–çŸ¥è¯†" },
                    { name: "è‡ªå¾‹è§„åˆ’", icon: "ğŸ“", gold: 2, xp: 5, desc: "å†™ä¸‹å¹¶æ‰§è¡Œä»Šæ—¥3é¡¹ä¸»è¦ä»»åŠ¡" }, 

                    { name: "åŸºåœ°ç»´æŠ¤: å®¶åŠ¡", icon: "ğŸ”§", gold: 2, xp: 5, desc: "æ´—ç¢—/å€’åƒåœ¾ç­‰ä¸»åŠ¨å®¶åŠ¡" },
                    { name: "ä½“èƒ½è®­ç»ƒ", icon: "ğŸƒ", gold: 2, xp: 5, desc: "è·³ç»³/è·‘æ­¥ç­‰è¿åŠ¨30åˆ†é’Ÿ" },
                    { name: "å†¥æƒ³é™å¿ƒ", icon: "ğŸ§˜", gold: 1, xp: 3, desc: "å®‰é™æ€è€ƒæˆ–å†¥æƒ³5åˆ†é’Ÿ" }
                ],
                weekendTasks: [
                    { name: "æˆ·å¤–æ¢ç´¢", icon: "ğŸš€", gold: 10, xp: 20, desc: "å¤–éƒ¨ç¯å¢ƒæ´»åŠ¨2å°æ—¶+" },
                    { name: "æ·±åº¦æ¸…æ´", icon: "ğŸ§¼", gold: 15, xp: 30, desc: "å¤§æ‰«é™¤æŸä¸€æŒ‡å®šåŒºåŸŸ" },
                    { name: "ä»»åŠ¡æ¸…é›¶", icon: "âš¡", gold: 5, xp: 10, desc: "å‘¨å…­ä¸­åˆå‰å®Œæˆæ‰€æœ‰æ—¥å¸¸ä»»åŠ¡" },
                    { name: "åŒç›Ÿå»ºç«‹: ç¤¾äº¤", icon: "ğŸ¤", gold: 8, xp: 15, desc: "ä¸äººç±»ä¼™ä¼´æˆ–å®¶äººäº’åŠ¨" },
                    { name: "çƒ¹é¥ªè¡¥ç»™", icon: "ğŸ‘¨â€ğŸ³", gold: 12, xp: 25, desc: "ååŠ©åˆ¶ä½œä¸€é¡¿é¥­èœ" },
                    { name: "å­¦é•¿äº’åŠ©", icon: "ğŸ§‘â€ğŸ¤â€ğŸ§‘", gold: 15, xp: 30, desc: "ä¸»åŠ¨å¸®åŠ©å¼Ÿå¼Ÿå­¦ä¹ æˆ–è§£å†³é—®é¢˜" }, 
                    { name: "è‰ºæœ¯åˆ›ä½œ", icon: "ğŸ¨", gold: 10, xp: 20, desc: "å®Œæˆä¸€å¹…ç”»ä½œæˆ–æ‰‹å·¥" },
                    { name: "ä¸ªäººåæ€", icon: "ğŸ§ ", gold: 8, xp: 15, desc: "å†™ä¸‹æœ¬å‘¨3ä¸ªè¿›æ­¥ä¸3ä¸ªå¾…æ”¹è¿›ç‚¹" }, 
                    { name: "æ·±åº¦é˜…è¯»", icon: "ğŸ“š", gold: 10, xp: 20, desc: "é˜…è¯»éè™šæ„ç±»ä¹¦ç±1å°æ—¶å¹¶åšç¬”è®°" }, 
                    { name: "ä¼‘æ¯ç»´æŠ¤", icon: "ğŸ“–", gold: 8, xp: 15, desc: "åˆä¼‘æˆ–å®‰é™ç‹¬å¤„1å°æ—¶" }
                ]
            },
            warrior: {
                name: "æ–½å¸¸æ¾",
                avatar: "âš”ï¸",
                color: "#ff0055", // éœ“è™¹çº¢
                levels: [
                    { xp: 0, title: "æ–°å…µ" }, { xp: 100, title: "çªå‡»æ‰‹" }, 
                    { xp: 300, title: "çš‡å®¶å«å£«" }, { xp: 600, title: "æˆ˜äº‰ä¹‹ç‹" }
                ],
                // æ–½å¸¸æ¾ - æ—¥å¸¸ä»»åŠ¡ (11é¡¹) - ä¾§é‡åŸºç¡€ä¹ æƒ¯ã€ä½œæ¯ã€è¡Œä¸ºæ§åˆ¶
                dailyTasks: [
                    { name: "ä¸ªäººæ¸…æ´", icon: "ğŸ§¼", gold: 1, xp: 3, desc: "æ—©æ™šä¸»åŠ¨æ´—è„¸ã€åˆ·ç‰™ã€è‡ªç†" },
                    { name: "æ™¨é—´åè®®: æ—©èµ·", icon: "â°", gold: 1, xp: 5, desc: "7:30å‰å®Œæˆå¯åŠ¨" }, // ä¸“é—¨é’ˆå¯¹æ‡’åºŠ
                    { name: "ä¼‘çœ æ¨¡å¼", icon: "ğŸŒ™", gold: 1, xp: 5, desc: "21:30å‰å‡†æ—¶å…¥ç¡" },
                    { name: "æ•´ç†èƒŒåŒ…", icon: "ğŸ’", gold: 1, xp: 3, desc: "æ£€æŸ¥å­¦ä¹ ç‰©å“æ˜¯å¦é½å…¨" },
                    { name: "è”¬èœæ‘„å…¥", icon: "ğŸ¥¦", gold: 1, xp: 3, desc: "ä¸»åŠ¨åƒå®ŒæŒ‡å®šè”¬èœä»½é‡" }, // ä¸“é—¨é’ˆå¯¹æŒ‘é£Ÿ

                    { name: "å®šåŠ›åŠ›åœº", icon: "ğŸ›¡ï¸", gold: 2, xp: 5, desc: "é™å20åˆ†é’Ÿå®Œæˆä½œä¸š" },
                    { name: "å‡†ç¡®ç‡æ ¡éªŒ", icon: "âœ…", gold: 3, xp: 10, desc: "ä½œä¸šæ­£ç¡®ç‡è¾¾90%+" },
                    { name: "æƒ…æŠ¥æ”¶é›†: é˜…è¯»", icon: "ğŸ’¾", gold: 3, xp: 10, desc: "é˜…è¯»å¹¶æ±‡æŠ¥æ•…äº‹å†…å®¹" },

                    { name: "æƒ…ç»ªæ§åˆ¶", icon: "ğŸ§˜", gold: 2, xp: 5, desc: "é‡åˆ°æŒ«æŠ˜ä¸å“­é—¹ã€ä¸å‘è„¾æ°”" },
                    { name: "å€¾å¬æŒ‡ä»¤", icon: "ğŸ‘‚", gold: 2, xp: 5, desc: "å¬å®Œçˆ¶æ¯æŒ‡ä»¤å†è¡ŒåŠ¨" },
                    { name: "è¿åŠ¨æ¨¡ç»„", icon: "âš½", gold: 2, xp: 5, desc: "æˆ·å¤–è·‘åŠ¨æˆ–è¿åŠ¨30åˆ†é’Ÿ" }
                ],
                weekendTasks: [
                    { name: "é—ªç”µæˆ˜(å‘¨äº”)", icon: "âš¡", gold: 15, xp: 30, desc: "å‘¨äº”æ™šæ¸…ç©ºæ‰€æœ‰ä»»åŠ¡" },
                    { name: "æˆ˜åœºæ¸…æ‰«", icon: "ğŸ§¹", gold: 8, xp: 15, desc: "å‘¨å…­ä¸­åˆå‰å®Œæˆå¤§æ‰«é™¤" },
                    { name: "å±è”½ä¿¡å·", icon: "ğŸ“µ", gold: 5, xp: 10, desc: "ç™½å¤©ä¸æ¥è§¦æ‰‹æœºã€å¹³æ¿" },
                    { name: "ç©å…·å½’ä½", icon: "ğŸ“¦", gold: 15, xp: 30, desc: "ç‹¬ç«‹æ•´ç†å¹¶å½’ä½æ‰€æœ‰ç©å…·" }, 
                    { name: "å›¢é˜Ÿåˆä½œ", icon: "ğŸ¤", gold: 8, xp: 15, desc: "ä¸å“¥å“¥åˆä½œå®Œæˆä¸€é¡¹å°ä»»åŠ¡" },
                    { name: "å¸®æ‰‹æ¨¡å¼", icon: "ğŸ§º", gold: 12, xp: 25, desc: "ååŠ©çˆ¶æ¯å®Œæˆä¸€é¡¹æŒ‡å®šå®¶åŠ¡" },
                    { name: "è€åŠ›æµ‹è¯•", icon: "ğŸ§±", gold: 10, xp: 20, desc: "è¿ç»­ç©ç§¯æœ¨/ç”»ç”»1å°æ—¶" },
                    { name: "å®‰é™é˜…è¯»", icon: "ğŸ“˜", gold: 10, xp: 20, desc: "å®‰é™é˜…è¯»ç»˜æœ¬æˆ–æ•…äº‹ä¹¦30åˆ†é’Ÿ" }, 
                    { name: "æ•…äº‹å¤è¿°", icon: "ğŸ¤", gold: 8, xp: 15, desc: "å‘çˆ¶æ¯å®Œæ•´å¤è¿°ä¸€ä¸ªæ•…äº‹" }, 
                    { name: "ä¼‘æ¯æŒ‡ä»¤", icon: "ğŸ˜´", gold: 5, xp: 10, desc: "æŒ‰æ—¶å®Œæˆåˆç¡æˆ–å®‰é™ä¼‘æ¯" }
                ]
            },
            shop: [
                { name: "å¹¸è¿è¡¥ç»™ç®±", icon: "ğŸ", price: 5, desc: "éšæœºæŠ½å–ç‰©èµ„æˆ–æƒ©ç½š" },
                { name: "å¨±ä¹æ¨¡ç»„30m", icon: "ğŸ®", price: 10, desc: "æ¸¸æˆ/å¹³æ¿æ—¶é—´" },
                { name: "èƒ½é‡æ¶² (é¥®æ–™)", icon: "ğŸ§ª", price: 15, desc: "å¯ä¹/é›ªç¢§/ç‰›å¥¶" },
                { name: "é›¶é£Ÿé…é¢", icon: "ğŸ¬", price: 20, desc: "æŒ‡å®šé›¶é£Ÿä¸€ä»½" }, 
                { name: "å‘¨æœ«æƒé™", icon: "ğŸ“º", price: 25, desc: "æŒ‡å®šè§‚çœ‹ç”µè§†å¡é€š/ç”µå½±" }, 
                { name: "ä¸´æ—¶å¢æ´", icon: "ğŸ‘¨â€ğŸ‘§â€ğŸ‘¦", price: 40, desc: "çˆ¶æ¯é™ªä¼´ç©è€30åˆ†é’Ÿ" }, 
                { name: "é«˜çº§å†›ç²®", icon: "ğŸ”", price: 50, desc: "éº¦å½“åŠ³/è‚¯å¾·åŸº" },
                { name: "é˜²å¾¡åŠ›åœº", icon: "ğŸ›¡ï¸", price: 80, desc: "æŠµæ¶ˆä¸€æ¬¡çˆ¶æ¯çš„æ‰¹è¯„" },
                { name: "ä¼ è¯´è£…å¤‡", icon: "ğŸ‘¾", price: 100, desc: "æŒ‡å®šç©å…·/æ¸¸æˆå¡å¸¦" },
                { name: "ä¸“å±ä»»åŠ¡å¡", icon: "ğŸ‘‘", price: 150, desc: "æŒ‡å®šçˆ¶æ¯å®Œæˆä¸€ä¸ªç®€å•å®¶åŠ¡" }
            ]
        };

        // ================= é€»è¾‘æ ¸å¿ƒ (åŒ…å«å¯†ç éªŒè¯) =================
        let currentRole = 'mage';
        let currentTab = 'daily';
        let userData = { mage: { gold: 0, xp: 0 }, warrior: { gold: 0, xp: 0 } };

        /**
         * å¯†ç éªŒè¯å‡½æ•°ï¼šæ‰€æœ‰åŠ åˆ†å’Œæ‰£åˆ†æ“ä½œå‰å¿…é¡»æ‰§è¡Œã€‚
         * @returns {boolean} éªŒè¯æ˜¯å¦é€šè¿‡
         */
        function authenticate() {
            // ä½¿ç”¨ prompt è¾“å…¥ï¼Œè¾“å…¥ç±»å‹é»˜è®¤ä¸º textï¼Œä½†åœ¨ç§»åŠ¨ç«¯é€šå¸¸ä¼šå¼¹å‡ºæ•°å­—é”®ç›˜
            const input = prompt("ã€æˆæƒéªŒè¯ã€‘\nè¯·å®¶é•¿è¾“å…¥ä»»åŠ¡ç¡®è®¤ç  (å››ä½æ•°å­—):");
            if (input === null || input === "") {
                alert("æˆæƒå–æ¶ˆã€‚");
                return false;
            }
            if (input === PARENT_PIN) {
                return true;
            } else {
                alert("æˆæƒç é”™è¯¯ï¼è¯·è”ç³»å®¶é•¿ã€‚");
                return false;
            }
        }

        function init() {
            const saved = localStorage.getItem('familyGuildV5');
            if (saved) userData = JSON.parse(saved);
            switchRole('mage');
        }

        function switchRole(role) {
            currentRole = role;
            const config = gameData[role];
            
            document.documentElement.style.setProperty('--theme-color', config.color);
            
            document.getElementById('btn-mage').className = role === 'mage' ? 'cyber-btn active' : 'cyber-btn';
            document.getElementById('btn-warrior').className = role === 'warrior' ? 'cyber-btn active' : 'cyber-btn';
            
            renderHUD();
            renderContent();
        }

        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.add('active');
            renderContent();
        }

        function renderHUD() {
            const data = userData[currentRole];
            const config = gameData[currentRole];
            
            let levelInfo = config.levels[0];
            let nextXp = config.levels[1].xp;
            for(let i=0; i<config.levels.length; i++) {
                if(data.xp >= config.levels[i].xp) {
                    levelInfo = config.levels[i];
                    nextXp = config.levels[i+1] ? config.levels[i+1].xp : config.levels[i].xp * 1.5;
                }
            }

            document.getElementById('ui-avatar').innerText = config.avatar;
            document.getElementById('ui-name').innerText = config.name;
            document.getElementById('ui-title').innerText = levelInfo.title;
            document.getElementById('ui-gold').innerText = data.gold;
            
            const percent = Math.min(100, (data.xp / nextXp) * 100);
            document.getElementById('ui-xp-bar').style.width = percent + "%";
            document.getElementById('ui-xp-txt').innerText = `${data.xp}/${nextXp} XP`; 
        }

        function renderContent() {
            const container = document.getElementById('content-area');
            container.innerHTML = '';
            
            let list = [];
            if(currentTab === 'daily') list = gameData[currentRole].dailyTasks;
            else if(currentTab === 'weekend') list = gameData[currentRole].weekendTasks;
            else list = gameData.shop;

            list.forEach(item => {
                const isShop = currentTab === 'shop';
                // åŠ¨ä½œç»‘å®šäº† authenticate()
                const action = isShop ? `buy('${item.name}', ${item.price})` : `doTask('${item.name}', ${item.gold}, ${item.xp})`;
                const priceTag = isShop 
                    ? `<div class="reward-tag cost-tag">-${item.price} G</div>`
                    : `<div class="reward-tag">+${item.gold} G / +${item.xp} XP</div>`;

                container.innerHTML += `
                    <div class="holo-card ${isShop?'shop-border':''}" onclick="${action}">
                        <div class="holo-icon">${item.icon}</div>
                        <div class="holo-title">${item.name}</div>
                        <div class="holo-desc">${item.desc}</div>
                        ${priceTag}
                    </div>
                `;
            });
        }

        function doTask(name, gold, xp) {
            // 1. å­©å­è¿›è¡Œåˆå§‹ç¡®è®¤
            if(!confirm(`å®¶é•¿ç¡®è®¤:\nå®Œæˆä»»åŠ¡: [${name}] ?\nå®Œæˆåå°†è·å¾— ${gold} é‡‘å¸, ${xp} ç»éªŒã€‚`)) return;

            // 2. å®¶é•¿è¿›è¡ŒæˆæƒéªŒè¯ (æ–°æ­¥éª¤)
            if (!authenticate()) return; 

            // 3. æˆæƒé€šè¿‡ï¼Œæ‰§è¡Œå¥–åŠ±
            userData[currentRole].gold += gold;
            userData[currentRole].xp += xp;
            save();
            alert(`ä»»åŠ¡å®Œæˆ!\nè·å¾— ${gold} é‡‘å¸, ${xp} ç»éªŒ!`);
        }

        function buy(name, price) {
            if(userData[currentRole].gold < price) {
                alert("âš ï¸ èµ„é‡‘ä¸è¶³ (é‡‘å¸ä¸è¶³)\nè¯·å®Œæˆæ›´å¤šä»»åŠ¡è·å–é‡‘å¸");
                return;
            }
            
            if(!confirm(`ç¡®è®¤è´­ä¹° [${name}]ï¼Œæ¶ˆè€— ${price} é‡‘å¸?`)) return;
            
            // è´­ä¹°å‰è¿›è¡ŒæˆæƒéªŒè¯ (æ–°æ­¥éª¤)
            if (!authenticate()) return; 

            // æ‰§è¡Œè´­ä¹°é€»è¾‘
            if(name.includes("è¡¥ç»™ç®±")) {
                userData[currentRole].gold -= price;
                save();
                
                const rand = Math.random();
                let msg = "";
                if(rand < 0.5) msg = "ğŸ’¨ ç©ºç®±å­... (è°¢è°¢æƒ é¡¾)";
                else if(rand < 0.8) { msg = "ğŸ’° å°‘é‡å›è¡€ (+3é‡‘å¸)"; userData[currentRole].gold += 3; }
                else if(rand < 0.95) msg = "ğŸ¥¤ è·å¾—è¡¥ç»™: é¥®æ–™ä¸€ç“¶!";
                else msg = "ğŸ”¥ ä¼ è¯´ç‰©å“: å…åšä½œä¸šåˆ¸!!!";
                setTimeout(() => alert(msg), 300);
            } else {
                userData[currentRole].gold -= price;
                save();
                alert(`äº¤æ˜“æˆåŠŸ! è¯·æ‰¾çˆ¶æ¯é¢†å–ç‰©å“: ${name}`);
            }
        }

        function save() {
            // æ•°æ®å­˜å‚¨åœ¨æµè§ˆå™¨æœ¬åœ°ï¼ˆlocalStorageï¼‰ï¼Œæ‰˜ç®¡åˆ° CF Pages åä¾ç„¶æœ‰æ•ˆã€‚
            localStorage.setItem('familyGuildV5', JSON.stringify(userData));
            renderHUD();
        }

        function resetData() {
            // é‡ç½®åŠŸèƒ½ä¹Ÿå—å¯†ç ä¿æŠ¤ (æ–°æ­¥éª¤)
            if (!authenticate()) return; 
            if(confirm("âš ï¸ è­¦å‘Š: å°†æ¸…é™¤æ‰€æœ‰ç³»ç»Ÿæ•°æ®! ç¡®è®¤æ¸…é™¤å—?")) {
                userData = { mage: { gold: 0, xp: 0 }, warrior: { gold: 0, xp: 0 } };
                save();
                alert("ç³»ç»Ÿå·²é‡ç½®ï¼Œæ•°æ®å½’é›¶ã€‚");
            }
        }

        init();
    </script>
</body>
</html>